<!DOCTYPE HTML>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="The personal website of Henrique Orefice">
	<meta name="keywords" content="Henrique Orefice, H. Orefice, horefice">
	<meta name="author" content="Henrique Orefice">
	<title>Paste</title>
	<style>
	body {
		margin: 0;
		width: 100%;
		overflow-x: hidden;
		font: normal large/1.4 monospace;
		color: #333;
		background-color: #fff;
		-webkit-font-smoothing: antialiased;
	}
	
	.container {
		margin: 3rem auto 6rem;
		padding: 0 5%;
		box-sizing: content-box;
		text-align: center;
	}
	</style>
</head>
<body>
	<div class="container">
		<h1>Paste</h1>
		<form id="paste">
			<label for="data">Data</label><br>
			<textarea id="data" name="data" rows="10" maxlength="9999" style="width: calc(80vw);" autofocus></textarea><br>
			<label for="alias">Alias</label><br>
			<input type="text" name="alias" required><br><br>
			<input type="submit">
		</form> 
	</div>
</body>
<script>
	var form = document.getElementById("paste");
	form.onsubmit = async (e) => {
		e.preventDefault();
        let formData = Object.fromEntries(new FormData(form));
        let url = "https://18ylhq4gne.execute-api.eu-west-1.amazonaws.com/default/paste-lambda";

		let response = !formData.data ? await fetch(url + "?alias=" + encodeURIComponent(formData.alias)) : await fetch(url, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify(formData)
        })
		let text = await response.json();
        console.log(text);
		document.querySelector("#data").innerHTML = text;
	};
</script>